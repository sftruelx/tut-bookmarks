<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout"
      layout:decorator="/decorator">
<head>

    <!-- END SCRIPTS -->
</head>
<body>
<div layout:fragment="content">
    <div class="page-container">
        <div class="page-content">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Select Table</h3>
                </div>
                <div class="panel-body">
                    <!-- START CHECKBOXES RADIO AND SELECT -->
                    <div id="toolbar">
                        <div class="form-inline" role="form">
                            <div class="form-group">
                                <span>Album Name </span>

                                <input name="albumName" class="form-control" type="text" placeholder="Search"/>
                                <button id="ok" type="submit" class="btn btn-primary"><i class="fa fa-search"></i>查找
                                </button>
                                <a id="edit" onclick="showmodal()" class="btn btn-primary"><i class="fa fa-edit"></i>编辑</a>

                            </div>
                        </div>
                    </div>
                    <table id="table"
                           data-classes="table  table-hover table-no-bordered table-responsable"
                           data-toggle="table"
                           data-toolbar="#toolbar"
                           data-query-params="queryParams"
                           data-url="/album"
                           data-side-pagination="server"
                           data-pagination="true"
                           data-page-list="[10]"
                           data-sort-name="AlbumName"
                           data-sort-order="desc">
                        <thead>
                        <tr>
                            <th data-field="state" data-checkbox="true"></th>
                            <th data-field="id">id</th>
                            <th data-field="albumName" data-formatter="urlFormatter">AlbumName</th>
                            <th data-field="author">Author</th>
                            <th data-field="classifyId">ClassifyId</th>
                            <th data-field="createTime">CreateTime</th>
                            <th data-field="descripe">Descripe</th>
                            <th data-field="publishDate">PublishDate</th>
                        </tr>
                        </thead>
                    </table>


                </div>
            </div>

        </div>

    </div>


    <!-- MODALS -->
    <div class="modal" id="mymodal" role="dialog" aria-labelledby="defModalHead" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span
                            aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                    <h4 class="modal-title" id="defModalHead">Basic Modal</h4>
                </div>
                <div class="modal-body">
                    Some content in modal example
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <script th:inline="javascript">/*<![CDATA[*/
    var editDialog;

    var $table = $('#table'),
            $ok = $('#ok');

    function showmodal(id) {

        editDialog.modal({
            remote: "/album/" + id ,
            show: true, backdrop: false
        });
//            editDialog.modal({
//                remote: "/test" + id + '&t=' + Math.random(1000),
//                show: true, backdrop: false
//            });

    }
    $(function () {

        editDialog = $("#mymodal").on("hidden.bs.modal", function () {
            $("#mymodal").removeData("bs.modal")
        });
        $ok.click(function () {
            $table.bootstrapTable('refresh');
        });
    });

    $("#pc_refresh").click(function () {
        function p_refresh_shown() {
            //alert("shown");
            //panel_refresh($("#pc_refresh").parents(".panel"),"hidden",function(){alert("hidden")});
        }

        panel_refresh($("#pc_refresh").parents(".panel"), "shown", p_refresh_shown);

    });
    function stateFormatter(value, row, index) {
        if (index === 2) {
            return {
                disabled: true
            };
        }
        if (index === 5) {
            return {
                disabled: true,
                checked: true
            }
        }
        return value;
    }


    function queryParams() {
        var params = {};
        $('#toolbar').find('input[name]').each(function () {
            params[$(this).attr('name')] = $(this).val();
        });
        return params;
    }

    function urlFormatter(value, row) {
        return '<a href="#" onclick=" showmodal('+ row.id +')" >'+ value +'</a>';
    }



    /*]]>*/</script>

</div>
</body>
</html>